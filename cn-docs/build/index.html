
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Flask-Excel - 格式万变，数据不变 &#8212; Flask-Excel 0.0.7 documentation</title>
    <link rel="stylesheet" href="_static/flasky.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
 
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-58933907-1']);
  _gaq.push(['_trackPageview']);
</script>

  </head><body>
  
  
  <div class=indexwrapper>
  


    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="flask-excel">
<h1><cite>Flask-Excel</cite> - 格式万变，数据不变<a class="headerlink" href="#flask-excel" title="Permalink to this headline">¶</a></h1>
<dl class="field-list simple">
<dt class="field-odd">作者</dt>
<dd class="field-odd"><p>C.W.</p>
</dd>
<dt class="field-even">源文件</dt>
<dd class="field-even"><p><a class="reference external" href="http://github.com/pyexcel-webwares/Flask-Excel.git">http://github.com/pyexcel-webwares/Flask-Excel.git</a></p>
</dd>
<dt class="field-odd">提交问题</dt>
<dd class="field-odd"><p><a class="reference external" href="http://github.com/pyexcel-webwares/Flask-Excel/issues">http://github.com/pyexcel-webwares/Flask-Excel/issues</a></p>
</dd>
<dt class="field-even">许可证</dt>
<dd class="field-even"><p>New BSD License</p>
</dd>
<dt class="field-odd">发布的版本</dt>
<dd class="field-odd"><p>0.0.7</p>
</dd>
<dt class="field-even">文档生成日期</dt>
<dd class="field-even"><p>Nov 09, 2020</p>
</dd>
</dl>
<p>以下是一段典型的开发人员和用户的对话:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>      <span class="n">用户</span><span class="p">:</span> <span class="s2">&quot;我上传了一个 excel 文件但是你的网页说文件格式不支持。&quot;</span>
<span class="n">开发人员</span><span class="p">:</span> <span class="s2">&quot;哪你上传的是 xlsx 格式还是 csv 格式？&quot;</span>
      <span class="n">用户</span><span class="p">:</span> <span class="s2">&quot;嗯，我不清楚。总之，我用的微软的 Excel 存的文件。哪一定是 excel 文件啦！&quot;</span>
<span class="n">开发人员</span><span class="p">:</span> <span class="s2">&quot;嗨，事情是这样：从第一天开始，你就没有告诉我要支持所有的 excel 格式。&quot;</span>
         <span class="s2">&quot;要么，将就一下。要么，把项目推迟 N 天。&quot;</span>
</pre></div>
</div>
<p><strong>Flask-Excel</strong> 是基于 <a class="reference external" href="https://github.com/pyexcel/pyexcel">pyexcel</a> 软件库。它的使命是让大家
在网站开发的时候，轻松的在数据存成 excel 文件让用户下载和处理用户上传的 excel 文件。
它可以把 excel 数据转换成二维数组，一维的字典数组和以excel 单页名为关键字，二维数组为值的字典；反之亦然。
这样的话，任由文件格式变化，你都可以在以下三个场景自由做数据转换:</p>
<ol class="arabic simple">
<li><p>excel 文件上传和下载</p></li>
<li><p>数据库输入输出</p></li>
<li><p>excel 数据分析和存储</p></li>
</ol>
<p>同时，<strong>Flask-Excel</strong> 有以下两个保证:</p>
<ol class="arabic simple">
<li><p>不管是任何文件格式，函数界面不变</p></li>
<li><p>不管是数据存在哪里，函数界面不变</p></li>
</ol>
<p>那么你就可以专注基于 Flask 的网站开发了。</p>
<p>最开始的时候，作者遇到一个可用性的问题：当一个简单的 excel 处理的网页交到用户手上的时候，
这些用户，像行政助理，人力资源管理人员，老会抱怨网页不好用。事实上，并不是所有人都知道
csv, xls, xslx 各有什么区别。与其花时间教育用户相关的微软办公室软件的用法，不如把
人类已知 excel 都给支持一下好了。同时为了在不修改代码情况下，我们能够通过装一个
插件就不一个新的 excel 格式支持了，<strong>pyexcel</strong> 的编程界面做了很好的抽象处理。在
整个 Python 社区，作者希望此软件包成为给 pandas 跑龙套的小包包。</p>
<p>可圈可点的性能：</p>
<ol class="arabic simple">
<li><p>为 excel 数据导入数据库和从数据库输出数据为 excel 格式提供一站式服务</p></li>
<li><p>把上传的 excel 文件直接转换成 Python 数据结构</p></li>
<li><p>把 Python 数据结构转换为 excel 文件让用户下载</p></li>
<li><p>在服务器里，把数据存成 excel 文件</p></li>
<li><p>支持 csv, tsv, csvz, tsvz 格式。其他格式有以下软件包支持：</p></li>
</ol>
<span id="a-map-of-plugins-and-file-formats"></span><span id="file-format-list"></span><table class="docutils align-default" id="id11">
<caption><span class="caption-text">文件格式插件列表</span><a class="headerlink" href="#id11" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 38%" />
<col style="width: 36%" />
<col style="width: 27%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>包包名字</p></th>
<th class="head"><p>文件格式</p></th>
<th class="head"><p>依赖</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference external" href="https://github.com/pyexcel/pyexcel-io">pyexcel-io</a></p></td>
<td><p>csv, csvz <a class="footnote-reference brackets" href="#f1" id="id1">1</a>, tsv,
tsvz <a class="footnote-reference brackets" href="#f2" id="id2">2</a></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><a class="reference external" href="https://github.com/pyexcel/pyexcel-xls">pyexcel-xls</a></p></td>
<td><p>xls, xlsx(read only),
xlsm(read only)</p></td>
<td><p><a class="reference external" href="https://github.com/python-excel/xlrd">xlrd</a>,
<a class="reference external" href="https://github.com/python-excel/xlwt">xlwt</a></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference external" href="https://github.com/pyexcel/pyexcel-xlsx">pyexcel-xlsx</a></p></td>
<td><p>xlsx</p></td>
<td><p><a class="reference external" href="https://bitbucket.org/openpyxl/openpyxl">openpyxl</a></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference external" href="https://github.com/pyexcel/pyexcel-ods3">pyexcel-ods3</a></p></td>
<td><p>ods</p></td>
<td><p><a class="reference external" href="https://github.com/pyexcel/pyexcel-ezodf">pyexcel-ezodf</a>,
lxml</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference external" href="https://github.com/pyexcel/pyexcel-ods">pyexcel-ods</a></p></td>
<td><p>ods</p></td>
<td><p><a class="reference external" href="https://github.com/eea/odfpy">odfpy</a></p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default" id="id12">
<caption><span class="caption-text">专门读或写的插件</span><a class="headerlink" href="#id12" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 38%" />
<col style="width: 36%" />
<col style="width: 27%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>包包名字</p></th>
<th class="head"><p>文件格式</p></th>
<th class="head"><p>依赖</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference external" href="https://github.com/pyexcel/pyexcel-xlsxw">pyexcel-xlsxw</a></p></td>
<td><p>xlsx(write only)</p></td>
<td><p><a class="reference external" href="https://github.com/jmcnamara/XlsxWriter">XlsxWriter</a></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference external" href="https://github.com/pyexcel/pyexcel-libxlsxw">pyexcel-libxlsxw</a></p></td>
<td><p>xlsx(write only)</p></td>
<td><p><a class="reference external" href="http://libxlsxwriter.github.io/getting_started.html">libxlsxwriter</a></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference external" href="https://github.com/pyexcel/pyexcel-xlsxr">pyexcel-xlsxr</a></p></td>
<td><p>xlsx(read only)</p></td>
<td><p>lxml</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference external" href="https://github.com/pyexcel/pyexcel-xlsbr">pyexcel-xlsbr</a></p></td>
<td><p>xlsb(read only)</p></td>
<td><p>pyxlsb</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference external" href="https://github.com/pyexcel/pyexcel-odsr">pyexcel-odsr</a></p></td>
<td><p>read only for ods, fods</p></td>
<td><p>lxml</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference external" href="https://github.com/pyexcel/pyexcel-odsw">pyexcel-odsw</a></p></td>
<td><p>write only for ods</p></td>
<td><p>loxun</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference external" href="https://github.com/pyexcel/pyexcel-htmlr">pyexcel-htmlr</a></p></td>
<td><p>html(read only)</p></td>
<td><p>lxml,html5lib</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference external" href="https://github.com/pyexcel/pyexcel-pdfr">pyexcel-pdfr</a></p></td>
<td><p>pdf(read only)</p></td>
<td><p>camelot</p></td>
</tr>
</tbody>
</table>
<div class="section" id="id3">
<h2>插件使用指南<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h2>
<p>从2020年开始，所有 pyexcel-io 的插件都需要至少 python 3.6 了。如果需要支持以前的
python 版本，请继续使用 0.5.x 。</p>
<p>除了 csv 文件， xls, xlsx 和 ods 文件都是一个压缩文件。里面都是 xml 文件。</p>
<p>只有专门的读写插件可以边读边用或者边转换边写。</p>
<p>如果管理所有已经装上了的插件呢？很简单，你可以用 pip 添加需要的插件，或者卸载不需要的插件。
如果你有不同的项目，而且项目的依赖不一样，作者推荐用 python 的 venv 来给你的每一个项目创建
一个新的虚拟 python 环境。有个别情况，两个插件需要共存，比如 pyexcel-ods 和 pyexcel-odsr，
前者可以写 ods 文件，但你需要后者来读 ods 文件。在这种情形下呢，你可以用 library 变量，
比如 get_array(‘my.ods’, library=’pyexcel-odsr’)。</p>
<table class="docutils align-default" id="id13">
<caption><span class="caption-text">其他的格式</span><a class="headerlink" href="#id13" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 29%" />
<col style="width: 28%" />
<col style="width: 21%" />
<col style="width: 22%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>包包名字</p></th>
<th class="head"><p>文件格式</p></th>
<th class="head"><p>依赖</p></th>
<th class="head"><p>Python 版本</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference external" href="https://github.com/pyexcel/pyexcel-text">pyexcel-text</a></p></td>
<td><p>write only:rst,
mediawiki, html,
latex, grid, pipe,
orgtbl, plain simple
read only: ndjson
r/w: json</p></td>
<td><p><a class="reference external" href="https://bitbucket.org/astanin/python-tabulate">tabulate</a></p></td>
<td><p>2.6, 2.7, 3.3, 3.4
3.5, 3.6, pypy</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference external" href="https://github.com/pyexcel/pyexcel-handsontable">pyexcel-handsontable</a></p></td>
<td><p>handsontable in html</p></td>
<td><p><a class="reference external" href="https://cdnjs.com/libraries/handsontable">handsontable</a></p></td>
<td><p>same as above</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference external" href="https://github.com/pyexcel/pyexcel-chart">pyexcel-pygal</a></p></td>
<td><p>svg chart</p></td>
<td><p><a class="reference external" href="https://github.com/Kozea/pygal">pygal</a></p></td>
<td><p>2.7, 3.3, 3.4, 3.5
3.6, pypy</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference external" href="https://github.com/pyexcel/pyexcel-sortable">pyexcel-sortable</a></p></td>
<td><p>sortable table in html</p></td>
<td><p><a class="reference external" href="https://github.com/vividvilla/csvtotable">csvtotable</a></p></td>
<td><p>same as above</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference external" href="https://github.com/pyexcel/pyexcel-gantt">pyexcel-gantt</a></p></td>
<td><p>gantt chart in html</p></td>
<td><p><a class="reference external" href="https://github.com/frappe/gantt">frappe-gantt</a></p></td>
<td><p>except pypy, same
as above</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Footnotes</p>
<dl class="footnote brackets">
<dt class="label" id="f1"><span class="brackets"><a class="fn-backref" href="#id1">1</a></span></dt>
<dd><p>压缩了的 csv 文件</p>
</dd>
<dt class="label" id="f2"><span class="brackets"><a class="fn-backref" href="#id2">2</a></span></dt>
<dd><p>压缩了的 tsv 文件</p>
</dd>
</dl>
</div>
<div class="section" id="id4">
<h2>安装<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h2>
<p>你可以通过 pip 安装 Flask-Excel ：</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ pip install Flask-Excel
</pre></div>
</div>
<p>或者复制到本地再安装：</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ git clone https://github.com/pyexcel-webwares/Flask-Excel.git
$ <span class="nb">cd</span> Flask-Excel
$ python setup.py install
</pre></div>
</div>
<p>每个插件的安装方法都有各自的文档。拿 xlsx 为例，你需要装 pyexcel-xlsx</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ pip install pyexcel-xlsx
</pre></div>
</div>
</div>
<div class="section" id="id5">
<h2>配置<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h2>
<p>In your application, you must import it before using it:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">flask_excel</span> <span class="k">as</span> <span class="nn">excel</span>

<span class="o">...</span>
<span class="n">excel</span><span class="o">.</span><span class="n">init_excel</span><span class="p">(</span><span class="n">app</span><span class="p">)</span> <span class="c1"># required since version 0.0.7</span>
</pre></div>
</div>
</div>
<div class="section" id="quick-start">
<h2>Quick start<a class="headerlink" href="#quick-start" title="Permalink to this headline">¶</a></h2>
<p>A minimal application may look like this:</p>
<p>The tiny application exposes four urls:</p>
<ol class="arabic simple">
<li><p>one for file upload</p></li>
<li><p>three urls for file download.</p></li>
</ol>
<p>The first url presents a simple file upload html and responds
back in json with the content of the uploaded file. Here is an
<a class="reference external" href="https://github.com/pyexcel/Flask-Excel/blob/master/examples/example_for_upload.csv">example file</a>
for testing but you can upload any other excel file. The file upload handler
uses <cite>request.get_array</cite> to parse the uploaded file and gets an array back.
The parameter <strong>file</strong> is coded in the html form:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="nb">input</span> <span class="o">...</span> <span class="n">name</span><span class="o">=</span><span class="n">file</span><span class="o">&gt;</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If ‘field_name’ was not specified, for example <cite>request.get_array(‘file’)</cite>
in upload_file() function, your browser would display “Bad Request: The
browser (or proxy) sent a request that this server could not understand.”</p>
</div>
<p>The rest of the links simply throw back a csv file whenever a http request is made to
<a class="reference external" href="http://localhost:50000/download/">http://localhost:50000/download/</a>. <code class="xref py py-meth docutils literal notranslate"><span class="pre">make_response_from_array()</span></code> takes a
list of lists and a file type as parameters and sets up the mime type of the
http response. If you would like to give ‘tsvz’ a go, please change “csv” to
“tsvz”.</p>
</div>
<div class="section" id="id6">
<h2>更多的文件格式<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h2>
<p>实例项目支持 csv, tsv 和他们的压缩版本: csvz and tsvz. 如果你需要其他的格式支持，
请参照:ref:<cite>file-format-list</cite>，你可以装一个或所有的:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">pyexcel</span><span class="o">-</span><span class="n">xls</span>
<span class="n">pip</span> <span class="n">install</span> <span class="n">pyexcel</span><span class="o">-</span><span class="n">xlsx</span>
<span class="n">pip</span> <span class="n">install</span> <span class="n">pyexcel</span><span class="o">-</span><span class="n">ods</span>
</pre></div>
</div>
</div>
<div class="section" id="data-import-and-export">
<h2>Data import and export<a class="headerlink" href="#data-import-and-export" title="Permalink to this headline">¶</a></h2>
<p>Continue with the previous example, the data import and export will be explained.
You can copy the following code in their own appearing sequence and paste them
after the place holder:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># insert database related code here</span>
</pre></div>
</div>
<p>Alternatively, you can find the complete example on
<a class="reference external" href="https://github.com/pyexcel/Flask-Excel/blob/master/examples/database_example.py">github</a></p>
<p>Now let’s add the following imports first:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">flask_sqlalchemy</span> <span class="kn">import</span> <span class="n">SQLAlchemy</span> <span class="c1"># sql operations</span>
</pre></div>
</div>
<p>And please make sure that you have pyexcel-xls and pyexcel-handsontable installed:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">pyexcel</span><span class="o">-</span><span class="n">xls</span><span class="p">,</span> <span class="n">pyexcel</span><span class="o">-</span><span class="n">handsontable</span>
</pre></div>
</div>
<p>Now configure the database connection. Sqllite will be used and <strong>tmp.db</strong> will
be used and can be found in your current working directory:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">app</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;SQLALCHEMY_DATABASE_URI&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;sqlite:///tmp.db&#39;</span>
<span class="n">db</span> <span class="o">=</span> <span class="n">SQLAlchemy</span><span class="p">(</span><span class="n">app</span><span class="p">)</span>
</pre></div>
</div>
<p>And paste some models from Flask-SQLAlchemy’s documentation:</p>
<p>Now let us create the tables in the database:</p>
<p>Write up the view functions for data import:</p>
<p>In the code, <cite>category_init_func</cite> and <cite>post_init_func</cite> are custom initialization
functions for Category and Post respectively. In the situation where you want to
skip certain rows, None should should be returned and flask_excel will ignore the row.</p>
<p>Write up the view function for data export:</p>
<p>Then run the example again. Visit <a class="reference external" href="http://localhost:5000/import">http://localhost:5000/import</a> and upload
<a class="reference external" href="https://github.com/pyexcel/Flask-Excel/blob/master/sample-data.xls">sample-data.xls</a>.</p>
<p>And it responds with</p>
<img alt="_images/handson-view.png" src="_images/handson-view.png" />
<p>This result is rendered via <a class="reference external" href="https://github.com/pyexcel/pyexcel-handsontable">pyexcel-handsontable</a>.
All you needed is to put ‘handsontable.html’ as file type:</p>
<p>Then visit <a class="reference external" href="http://localhost:5000/export">http://localhost:5000/export</a> to download the data back.</p>
</div>
<div class="section" id="export-filtered-query-sets">
<h2>Export filtered query sets<a class="headerlink" href="#export-filtered-query-sets" title="Permalink to this headline">¶</a></h2>
<p>Previous example shows you how to dump one or more tables over http protocol.
Hereby, let’s look at how to turn a query sets into an excel sheet. You can
pass a query sets and an array of selected column names to
<a class="reference internal" href="#flask_excel.make_response_from_query_sets" title="flask_excel.make_response_from_query_sets"><code class="xref py py-meth docutils literal notranslate"><span class="pre">make_response_from_query_sets()</span></code></a> and generate an excel sheet from it:</p>
<p>Then visit <a class="reference external" href="http://localhost:5000/custom_export">http://localhost:5000/custom_export</a> to download the data
.. _data-types-and-its-conversion-funcs:</p>
</div>
<div class="section" id="id8">
<h2>所有支持的数据结构<a class="headerlink" href="#id8" title="Permalink to this headline">¶</a></h2>
<p>示例应用展示了数列，并不代表只有数列，其他的数据结构也是支持的。 以下是所有的数据结构列表:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 20%" />
<col style="width: 42%" />
<col style="width: 38%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>data structure</p></th>
<th class="head"><p>from file to data structures</p></th>
<th class="head"><p>from data structures to response</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>dict</p></td>
<td><p><a class="reference internal" href="#flask_excel.ExcelRequest.get_dict" title="flask_excel.ExcelRequest.get_dict"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_dict()</span></code></a></p></td>
<td><p><a class="reference internal" href="#flask_excel.make_response_from_dict" title="flask_excel.make_response_from_dict"><code class="xref py py-meth docutils literal notranslate"><span class="pre">make_response_from_dict()</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p>records</p></td>
<td><p><a class="reference internal" href="#flask_excel.ExcelRequest.get_records" title="flask_excel.ExcelRequest.get_records"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_records()</span></code></a></p></td>
<td><p><a class="reference internal" href="#flask_excel.make_response_from_records" title="flask_excel.make_response_from_records"><code class="xref py py-meth docutils literal notranslate"><span class="pre">make_response_from_records()</span></code></a></p></td>
</tr>
<tr class="row-even"><td><p>a list of lists</p></td>
<td><p><a class="reference internal" href="#flask_excel.ExcelRequest.get_array" title="flask_excel.ExcelRequest.get_array"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_array()</span></code></a></p></td>
<td><p><a class="reference internal" href="#flask_excel.make_response_from_array" title="flask_excel.make_response_from_array"><code class="xref py py-meth docutils literal notranslate"><span class="pre">make_response_from_array()</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p>dict of a list of lists</p></td>
<td><p><a class="reference internal" href="#flask_excel.ExcelRequest.get_book_dict" title="flask_excel.ExcelRequest.get_book_dict"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_book_dict()</span></code></a></p></td>
<td><p><a class="reference internal" href="#flask_excel.make_response_from_book_dict" title="flask_excel.make_response_from_book_dict"><code class="xref py py-meth docutils literal notranslate"><span class="pre">make_response_from_book_dict()</span></code></a></p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-class docutils literal notranslate"><span class="pre">pyexcel.Sheet</span></code></p></td>
<td><p><a class="reference internal" href="#flask_excel.ExcelRequest.get_sheet" title="flask_excel.ExcelRequest.get_sheet"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_sheet()</span></code></a></p></td>
<td><p><a class="reference internal" href="#flask_excel.make_response" title="flask_excel.make_response"><code class="xref py py-meth docutils literal notranslate"><span class="pre">make_response()</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-class docutils literal notranslate"><span class="pre">pyexcel.Book</span></code></p></td>
<td><p><a class="reference internal" href="#flask_excel.ExcelRequest.get_book" title="flask_excel.ExcelRequest.get_book"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_book()</span></code></a></p></td>
<td><p><a class="reference internal" href="#flask_excel.make_response" title="flask_excel.make_response"><code class="xref py py-meth docutils literal notranslate"><span class="pre">make_response()</span></code></a></p></td>
</tr>
<tr class="row-even"><td><p>database table</p></td>
<td><p><a class="reference internal" href="#flask_excel.ExcelRequest.save_to_database" title="flask_excel.ExcelRequest.save_to_database"><code class="xref py py-meth docutils literal notranslate"><span class="pre">save_to_database()</span></code></a>
<a class="reference internal" href="#flask_excel.ExcelRequest.isave_to_database" title="flask_excel.ExcelRequest.isave_to_database"><code class="xref py py-meth docutils literal notranslate"><span class="pre">isave_to_database()</span></code></a></p></td>
<td><p><a class="reference internal" href="#flask_excel.make_response_from_a_table" title="flask_excel.make_response_from_a_table"><code class="xref py py-meth docutils literal notranslate"><span class="pre">make_response_from_a_table()</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p>a list of database tables</p></td>
<td><p><a class="reference internal" href="#flask_excel.ExcelRequest.save_book_to_database" title="flask_excel.ExcelRequest.save_book_to_database"><code class="xref py py-meth docutils literal notranslate"><span class="pre">save_book_to_database()</span></code></a>
<a class="reference internal" href="#flask_excel.ExcelRequest.isave_book_to_database" title="flask_excel.ExcelRequest.isave_book_to_database"><code class="xref py py-meth docutils literal notranslate"><span class="pre">isave_book_to_database()</span></code></a></p></td>
<td><p><a class="reference internal" href="#flask_excel.make_response_from_tables" title="flask_excel.make_response_from_tables"><code class="xref py py-meth docutils literal notranslate"><span class="pre">make_response_from_tables()</span></code></a></p></td>
</tr>
<tr class="row-even"><td><p>a database query sets</p></td>
<td></td>
<td><p><a class="reference internal" href="#flask_excel.make_response_from_query_sets" title="flask_excel.make_response_from_query_sets"><code class="xref py py-meth docutils literal notranslate"><span class="pre">make_response_from_query_sets()</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p>a generator for records</p></td>
<td><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">iget_records()</span></code></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>a generator of lists</p></td>
<td><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">iget_array()</span></code></p></td>
<td></td>
</tr>
</tbody>
</table>
<p>需要更多信息的话，可以参照 <span class="xref std std-ref">pyexcel documentation</span></p>
</div>
<div class="section" id="id9">
<h2>支持<a class="headerlink" href="#id9" title="Permalink to this headline">¶</a></h2>
<p>如果您觉得作者的付出对您有帮助，您可以给作者小女儿送个小玩具。谢谢您的支持！</p>
<a class="reference internal image-reference" href="https://user-images.githubusercontent.com/4280312/98528713-979afe00-2274-11eb-9a98-8b3d75a83be2.png"><img alt="https://user-images.githubusercontent.com/4280312/98528713-979afe00-2274-11eb-9a98-8b3d75a83be2.png" src="https://user-images.githubusercontent.com/4280312/98528713-979afe00-2274-11eb-9a98-8b3d75a83be2.png" style="width: 200px;" /></a>
<a class="reference internal image-reference" href="https://user-images.githubusercontent.com/4280312/98529289-56efb480-2275-11eb-940f-be9f01ce0728.png"><img alt="https://user-images.githubusercontent.com/4280312/98529289-56efb480-2275-11eb-940f-be9f01ce0728.png" src="https://user-images.githubusercontent.com/4280312/98529289-56efb480-2275-11eb-940f-be9f01ce0728.png" style="width: 200px;" /></a>
</div>
<div class="section" id="id10">
<h2>函数参考<a class="headerlink" href="#id10" title="Permalink to this headline">¶</a></h2>
<p><strong>Flask-Excel</strong> attaches <strong>pyexcel</strong> functions to <strong>Request</strong> class.</p>
<span class="target" id="module-flask_excel.ExcelRequest"></span><div class="section" id="excelrequest">
<h3>ExcelRequest<a class="headerlink" href="#excelrequest" title="Permalink to this headline">¶</a></h3>
<dl class="py method">
<dt id="flask_excel.ExcelRequest.get_sheet">
<code class="sig-prename descclassname">flask_excel.ExcelRequest.</code><code class="sig-name descname">get_sheet</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">field_name</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">sheet_name</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">keywords</span></em><span class="sig-paren">)</span><a class="headerlink" href="#flask_excel.ExcelRequest.get_sheet" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>field_name</strong> – the file field name in the html form for file upload</p></li>
<li><p><strong>sheet_name</strong> – For an excel book, there could be multiple sheets. If it is left
unspecified, the sheet at index 0 is loaded. For ‘csv’, ‘tsv’ file,
<em>sheet_name</em> should be None anyway.</p></li>
<li><p><strong>keywords</strong> – additional keywords to <code class="xref py py-meth docutils literal notranslate"><span class="pre">pyexcel.get_sheet()</span></code></p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A sheet object</p>
</dd>
</dl>
<p>The following html form, the <em>field_name</em> should be “file”:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&lt;!doctype html&gt;
&lt;title&gt;Upload an excel file&lt;/title&gt;
&lt;h1&gt;Excel file upload (csv, tsv, csvz, tsvz only)&lt;/h1&gt;
&lt;form action=&quot;&quot; method=post enctype=multipart/form-data&gt;&lt;p&gt;
&lt;input type=file name=file&gt;&lt;input type=submit value=Upload&gt;
&lt;/form&gt;
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="flask_excel.ExcelRequest.get_array">
<code class="sig-prename descclassname">flask_excel.ExcelRequest.</code><code class="sig-name descname">get_array</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">field_name</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">sheet_name</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">keywords</span></em><span class="sig-paren">)</span><a class="headerlink" href="#flask_excel.ExcelRequest.get_array" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>field_name</strong> – same as <a class="reference internal" href="#flask_excel.ExcelRequest.get_sheet" title="flask_excel.ExcelRequest.get_sheet"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_sheet()</span></code></a></p></li>
<li><p><strong>sheet_name</strong> – same as <a class="reference internal" href="#flask_excel.ExcelRequest.get_sheet" title="flask_excel.ExcelRequest.get_sheet"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_sheet()</span></code></a></p></li>
<li><p><strong>keywords</strong> – additional keywords to pyexcel library</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a two dimensional array, a list of lists</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="flask_excel.ExcelRequest.get_dict">
<code class="sig-prename descclassname">flask_excel.ExcelRequest.</code><code class="sig-name descname">get_dict</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">field_name</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">sheet_name</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">name_columns_by_row</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">keywords</span></em><span class="sig-paren">)</span><a class="headerlink" href="#flask_excel.ExcelRequest.get_dict" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>field_name</strong> – same as <a class="reference internal" href="#flask_excel.ExcelRequest.get_sheet" title="flask_excel.ExcelRequest.get_sheet"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_sheet()</span></code></a></p></li>
<li><p><strong>sheet_name</strong> – same as <a class="reference internal" href="#flask_excel.ExcelRequest.get_sheet" title="flask_excel.ExcelRequest.get_sheet"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_sheet()</span></code></a></p></li>
<li><p><strong>name_columns_by_row</strong> – uses the first row of the sheet to be column headers by default.</p></li>
<li><p><strong>keywords</strong> – additional keywords to pyexcel library</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a dictionary of the file content</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="flask_excel.ExcelRequest.get_records">
<code class="sig-prename descclassname">flask_excel.ExcelRequest.</code><code class="sig-name descname">get_records</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">field_name</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">sheet_name</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">name_columns_by_row</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">keywords</span></em><span class="sig-paren">)</span><a class="headerlink" href="#flask_excel.ExcelRequest.get_records" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>field_name</strong> – same as <a class="reference internal" href="#flask_excel.ExcelRequest.get_sheet" title="flask_excel.ExcelRequest.get_sheet"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_sheet()</span></code></a></p></li>
<li><p><strong>sheet_name</strong> – same as <a class="reference internal" href="#flask_excel.ExcelRequest.get_sheet" title="flask_excel.ExcelRequest.get_sheet"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_sheet()</span></code></a></p></li>
<li><p><strong>name_columns_by_row</strong> – uses the first row of the sheet to be record field names by default.</p></li>
<li><p><strong>keywords</strong> – additional keywords to pyexcel library</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a list of dictionary of the file content</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="flask_excel.ExcelRequest.get_book">
<code class="sig-prename descclassname">flask_excel.ExcelRequest.</code><code class="sig-name descname">get_book</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">field_name</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">keywords</span></em><span class="sig-paren">)</span><a class="headerlink" href="#flask_excel.ExcelRequest.get_book" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>field_name</strong> – same as <a class="reference internal" href="#flask_excel.ExcelRequest.get_sheet" title="flask_excel.ExcelRequest.get_sheet"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_sheet()</span></code></a></p></li>
<li><p><strong>keywords</strong> – additional keywords to pyexcel library</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a two dimensional array, a list of lists</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="flask_excel.ExcelRequest.get_book_dict">
<code class="sig-prename descclassname">flask_excel.ExcelRequest.</code><code class="sig-name descname">get_book_dict</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">field_name</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">keywords</span></em><span class="sig-paren">)</span><a class="headerlink" href="#flask_excel.ExcelRequest.get_book_dict" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>field_name</strong> – same as <a class="reference internal" href="#flask_excel.ExcelRequest.get_sheet" title="flask_excel.ExcelRequest.get_sheet"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_sheet()</span></code></a></p></li>
<li><p><strong>keywords</strong> – additional keywords to pyexcel library</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a two dimensional array, a list of lists</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="flask_excel.ExcelRequest.save_to_database">
<code class="sig-prename descclassname">flask_excel.ExcelRequest.</code><code class="sig-name descname">save_to_database</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">field_name</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">session</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">table</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">initializer</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">mapdict</span><span class="o">=</span><span class="default_value">None ** keywords</span></em><span class="sig-paren">)</span><a class="headerlink" href="#flask_excel.ExcelRequest.save_to_database" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>field_name</strong> – same as <a class="reference internal" href="#flask_excel.ExcelRequest.get_sheet" title="flask_excel.ExcelRequest.get_sheet"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_sheet()</span></code></a></p></li>
<li><p><strong>session</strong> – a SQLAlchemy session</p></li>
<li><p><strong>table</strong> – a database table</p></li>
<li><p><strong>initializer</strong> – a custom table initialization function if you have one</p></li>
<li><p><strong>mapdict</strong> – the explicit table column names if your excel data do not have the exact column names</p></li>
<li><p><strong>keywords</strong> – additional keywords to <code class="xref py py-meth docutils literal notranslate"><span class="pre">pyexcel.Sheet.save_to_database()</span></code></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="flask_excel.ExcelRequest.isave_to_database">
<code class="sig-prename descclassname">flask_excel.ExcelRequest.</code><code class="sig-name descname">isave_to_database</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">field_name</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">session</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">table</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">initializer</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">mapdict</span><span class="o">=</span><span class="default_value">None ** keywords</span></em><span class="sig-paren">)</span><a class="headerlink" href="#flask_excel.ExcelRequest.isave_to_database" title="Permalink to this definition">¶</a></dt>
<dd><p>similar to <code class="xref py py-meth docutils literal notranslate"><span class="pre">:meth:`~flask_excel.ExcelRequest.isave_to_database()</span></code>. But it requires
less memory.</p>
<p>This requires column names must be at the first row.</p>
</dd></dl>

<dl class="py method">
<dt id="flask_excel.ExcelRequest.save_book_to_database">
<code class="sig-prename descclassname">flask_excel.ExcelRequest.</code><code class="sig-name descname">save_book_to_database</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">field_name</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">session</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">tables</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">initializers</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">mapdicts</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">keywords</span></em><span class="sig-paren">)</span><a class="headerlink" href="#flask_excel.ExcelRequest.save_book_to_database" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>field_name</strong> – same as  <a class="reference internal" href="#flask_excel.ExcelRequest.get_sheet" title="flask_excel.ExcelRequest.get_sheet"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_sheet()</span></code></a></p></li>
<li><p><strong>session</strong> – a SQLAlchemy session</p></li>
<li><p><strong>tables</strong> – a list of database tables</p></li>
<li><p><strong>initializers</strong> – a list of model initialization functions.</p></li>
<li><p><strong>mapdicts</strong> – a list of explicit table column names if your excel data sheets do not have the exact column names</p></li>
<li><p><strong>keywords</strong> – additional keywords to <code class="xref py py-meth docutils literal notranslate"><span class="pre">pyexcel.Book.save_to_database()</span></code></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="flask_excel.ExcelRequest.isave_book_to_database">
<code class="sig-prename descclassname">flask_excel.ExcelRequest.</code><code class="sig-name descname">isave_book_to_database</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">field_name</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">session</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">tables</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">initializers</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">mapdicts</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">keywords</span></em><span class="sig-paren">)</span><a class="headerlink" href="#flask_excel.ExcelRequest.isave_book_to_database" title="Permalink to this definition">¶</a></dt>
<dd><p>similar to <code class="xref py py-meth docutils literal notranslate"><span class="pre">:meth:`~flask_excel.ExcelRequest.isave_book_to_database()</span></code>. But it requires
less memory.</p>
<p>This requires column names must be at the first row in each sheets</p>
</dd></dl>

</div>
<div class="section" id="module-flask_excel">
<span id="response-methods"></span><h3>Response methods<a class="headerlink" href="#module-flask_excel" title="Permalink to this headline">¶</a></h3>
<dl class="py method">
<dt id="flask_excel.make_response">
<code class="sig-prename descclassname">flask_excel.</code><code class="sig-name descname">make_response</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pyexcel_instance</span></em>, <em class="sig-param"><span class="n">file_type</span></em>, <em class="sig-param"><span class="n">status</span><span class="o">=</span><span class="default_value">200</span></em>, <em class="sig-param"><span class="n">file_name</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#flask_excel.make_response" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pyexcel_instance</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">pyexcel.Sheet</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">pyexcel.Book</span></code></p></li>
<li><p><strong>file_type</strong> – <p>one of the following strings:</p>
<ul>
<li><p>’csv’</p></li>
<li><p>’tsv’</p></li>
<li><p>’csvz’</p></li>
<li><p>’tsvz’</p></li>
<li><p>’xls’</p></li>
<li><p>’xlsx’</p></li>
<li><p>’xlsm’</p></li>
<li><p>’ods’</p></li>
</ul>
</p></li>
<li><p><strong>status</strong> – unless a different status is to be returned.</p></li>
<li><p><strong>file_name</strong> – provide a custom file name for the response, excluding the file extension</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="flask_excel.make_response_from_array">
<code class="sig-prename descclassname">flask_excel.</code><code class="sig-name descname">make_response_from_array</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">array</span></em>, <em class="sig-param"><span class="n">file_type</span></em>, <em class="sig-param"><span class="n">status</span><span class="o">=</span><span class="default_value">200</span></em>, <em class="sig-param"><span class="n">file_name</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#flask_excel.make_response_from_array" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>array</strong> – a list of lists</p></li>
<li><p><strong>file_type</strong> – same as <a class="reference internal" href="#flask_excel.make_response" title="flask_excel.make_response"><code class="xref py py-meth docutils literal notranslate"><span class="pre">make_response()</span></code></a></p></li>
<li><p><strong>status</strong> – same as <a class="reference internal" href="#flask_excel.make_response" title="flask_excel.make_response"><code class="xref py py-meth docutils literal notranslate"><span class="pre">make_response()</span></code></a></p></li>
<li><p><strong>file_name</strong> – same as <a class="reference internal" href="#flask_excel.make_response" title="flask_excel.make_response"><code class="xref py py-meth docutils literal notranslate"><span class="pre">make_response()</span></code></a></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="flask_excel.make_response_from_dict">
<code class="sig-prename descclassname">flask_excel.</code><code class="sig-name descname">make_response_from_dict</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">dict</span></em>, <em class="sig-param"><span class="n">file_type</span></em>, <em class="sig-param"><span class="n">status</span><span class="o">=</span><span class="default_value">200</span></em>, <em class="sig-param"><span class="n">file_name</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#flask_excel.make_response_from_dict" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dict</strong> – a dictionary of lists</p></li>
<li><p><strong>file_type</strong> – same as <a class="reference internal" href="#flask_excel.make_response" title="flask_excel.make_response"><code class="xref py py-meth docutils literal notranslate"><span class="pre">make_response()</span></code></a></p></li>
<li><p><strong>status</strong> – same as <a class="reference internal" href="#flask_excel.make_response" title="flask_excel.make_response"><code class="xref py py-meth docutils literal notranslate"><span class="pre">make_response()</span></code></a></p></li>
<li><p><strong>file_name</strong> – same as <a class="reference internal" href="#flask_excel.make_response" title="flask_excel.make_response"><code class="xref py py-meth docutils literal notranslate"><span class="pre">make_response()</span></code></a></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="flask_excel.make_response_from_records">
<code class="sig-prename descclassname">flask_excel.</code><code class="sig-name descname">make_response_from_records</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">records</span></em>, <em class="sig-param"><span class="n">file_type</span></em>, <em class="sig-param"><span class="n">status</span><span class="o">=</span><span class="default_value">200</span></em>, <em class="sig-param"><span class="n">file_name</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#flask_excel.make_response_from_records" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>records</strong> – a list of dictionaries</p></li>
<li><p><strong>file_type</strong> – same as <a class="reference internal" href="#flask_excel.make_response" title="flask_excel.make_response"><code class="xref py py-meth docutils literal notranslate"><span class="pre">make_response()</span></code></a></p></li>
<li><p><strong>status</strong> – same as <a class="reference internal" href="#flask_excel.make_response" title="flask_excel.make_response"><code class="xref py py-meth docutils literal notranslate"><span class="pre">make_response()</span></code></a></p></li>
<li><p><strong>file_name</strong> – same as <a class="reference internal" href="#flask_excel.make_response" title="flask_excel.make_response"><code class="xref py py-meth docutils literal notranslate"><span class="pre">make_response()</span></code></a></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="flask_excel.make_response_from_book_dict">
<code class="sig-prename descclassname">flask_excel.</code><code class="sig-name descname">make_response_from_book_dict</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">book_dict</span></em>, <em class="sig-param"><span class="n">file_type</span></em>, <em class="sig-param"><span class="n">status</span><span class="o">=</span><span class="default_value">200</span></em>, <em class="sig-param"><span class="n">file_name</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#flask_excel.make_response_from_book_dict" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>book_dict</strong> – a dictionary of two dimensional arrays</p></li>
<li><p><strong>file_type</strong> – same as <a class="reference internal" href="#flask_excel.make_response" title="flask_excel.make_response"><code class="xref py py-meth docutils literal notranslate"><span class="pre">make_response()</span></code></a></p></li>
<li><p><strong>status</strong> – same as <a class="reference internal" href="#flask_excel.make_response" title="flask_excel.make_response"><code class="xref py py-meth docutils literal notranslate"><span class="pre">make_response()</span></code></a></p></li>
<li><p><strong>file_name</strong> – same as <a class="reference internal" href="#flask_excel.make_response" title="flask_excel.make_response"><code class="xref py py-meth docutils literal notranslate"><span class="pre">make_response()</span></code></a></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="flask_excel.make_response_from_a_table">
<code class="sig-prename descclassname">flask_excel.</code><code class="sig-name descname">make_response_from_a_table</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">session</span></em>, <em class="sig-param"><span class="n">table</span></em>, <em class="sig-param"><span class="n">file_type</span></em>, <em class="sig-param"><span class="n">status</span><span class="o">=</span><span class="default_value">200</span></em>, <em class="sig-param"><span class="n">file_name</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#flask_excel.make_response_from_a_table" title="Permalink to this definition">¶</a></dt>
<dd><p>Produce a single sheet Excel book of <em>file_type</em></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>session</strong> – SQLAlchemy session</p></li>
<li><p><strong>table</strong> – a SQLAlchemy table</p></li>
<li><p><strong>file_type</strong> – same as <a class="reference internal" href="#flask_excel.make_response" title="flask_excel.make_response"><code class="xref py py-meth docutils literal notranslate"><span class="pre">make_response()</span></code></a></p></li>
<li><p><strong>status</strong> – same as <a class="reference internal" href="#flask_excel.make_response" title="flask_excel.make_response"><code class="xref py py-meth docutils literal notranslate"><span class="pre">make_response()</span></code></a></p></li>
<li><p><strong>file_name</strong> – same as <a class="reference internal" href="#flask_excel.make_response" title="flask_excel.make_response"><code class="xref py py-meth docutils literal notranslate"><span class="pre">make_response()</span></code></a></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="flask_excel.make_response_from_query_sets">
<code class="sig-prename descclassname">flask_excel.</code><code class="sig-name descname">make_response_from_query_sets</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">query_sets</span></em>, <em class="sig-param"><span class="n">column_names</span></em>, <em class="sig-param"><span class="n">file_type</span></em>, <em class="sig-param"><span class="n">status</span><span class="o">=</span><span class="default_value">200</span></em>, <em class="sig-param"><span class="n">file_name</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#flask_excel.make_response_from_query_sets" title="Permalink to this definition">¶</a></dt>
<dd><p>Produce a single sheet Excel book of <em>file_type</em> from your custom database queries</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>query_sets</strong> – a query set</p></li>
<li><p><strong>column_names</strong> – a nominated column names. It could not be None, otherwise no data is returned.</p></li>
<li><p><strong>file_type</strong> – same as <a class="reference internal" href="#flask_excel.make_response" title="flask_excel.make_response"><code class="xref py py-meth docutils literal notranslate"><span class="pre">make_response()</span></code></a></p></li>
<li><p><strong>status</strong> – same as <a class="reference internal" href="#flask_excel.make_response" title="flask_excel.make_response"><code class="xref py py-meth docutils literal notranslate"><span class="pre">make_response()</span></code></a></p></li>
<li><p><strong>file_name</strong> – same as <a class="reference internal" href="#flask_excel.make_response" title="flask_excel.make_response"><code class="xref py py-meth docutils literal notranslate"><span class="pre">make_response()</span></code></a></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="flask_excel.make_response_from_tables">
<code class="sig-prename descclassname">flask_excel.</code><code class="sig-name descname">make_response_from_tables</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">session</span></em>, <em class="sig-param"><span class="n">tables</span></em>, <em class="sig-param"><span class="n">file_type</span></em>, <em class="sig-param"><span class="n">status</span><span class="o">=</span><span class="default_value">200</span></em>, <em class="sig-param"><span class="n">file_name</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#flask_excel.make_response_from_tables" title="Permalink to this definition">¶</a></dt>
<dd><p>Produce a multiple sheet Excel book of <em>file_type</em>. It becomes the same
as <a class="reference internal" href="#flask_excel.make_response_from_a_table" title="flask_excel.make_response_from_a_table"><code class="xref py py-meth docutils literal notranslate"><span class="pre">make_response_from_a_table()</span></code></a> if you pass <em>tables</em>
with an array that has a single table</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>session</strong> – SQLAlchemy session</p></li>
<li><p><strong>tables</strong> – SQLAlchemy tables</p></li>
<li><p><strong>file_type</strong> – same as <a class="reference internal" href="#flask_excel.make_response" title="flask_excel.make_response"><code class="xref py py-meth docutils literal notranslate"><span class="pre">make_response()</span></code></a></p></li>
<li><p><strong>status</strong> – same as <a class="reference internal" href="#flask_excel.make_response" title="flask_excel.make_response"><code class="xref py py-meth docutils literal notranslate"><span class="pre">make_response()</span></code></a></p></li>
<li><p><strong>file_name</strong> – same as <a class="reference internal" href="#flask_excel.make_response" title="flask_excel.make_response"><code class="xref py py-meth docutils literal notranslate"><span class="pre">make_response()</span></code></a></p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
</div>
</div>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
  
    <a href="http://github.com/pyexcel-webwares/Flask-Excel"><img style="position: fixed; top: 0; right: 0; border: 0;"
    src="http://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png" alt="Fork me on GitHub" /></a>
  


  
  </div>
  

<div class="footer">Copyright 2015 C. W. <br>
  This page uses <a href="http://analytics.google.com/">
Google Analytics</a> to collect statistics. You can disable it by blocking
the JavaScript coming from www.google-analytics.com.
<script type="text/javascript">
  (function() {
    var ga = document.createElement('script');
    ga.src = ('https:' == document.location.protocol ?
              'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    ga.setAttribute('async', 'true');
    document.documentElement.firstChild.appendChild(ga);
  })();
</script>
</div>

  </body>
</html>